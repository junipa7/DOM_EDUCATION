<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>[BASE] íƒ€ì´ë° í˜¼ë™ìœ¼ë¡œ ì¸í•œ UX/ë¡œê·¸ ë¶ˆì•ˆì •</title>

  <!-- ë™ê¸° ìŠ¤í¬ë¦½íŠ¸(ë°ì´í„° URI). HTML íŒŒì‹±ì„ 'ì˜ë„ì ìœ¼ë¡œ' ì ê¹ ë§‰ì•„ ë³‘ëª© ì¬í˜„ -->
  <script src="data:text/javascript;charset=utf-8,
    (function(){
      const start = performance.now();
      while(performance.now() - start < 80){} // ~80ms busy-wait to simulate blocking
      console.log('[BASE SDK] ë™ê¸° ë¡œë”© ì™„ë£Œ(íŒŒì‹± ì°¨ë‹¨ ì‹œë®¬ë ˆì´ì…˜)');
    })();
  "></script>

  <script>
    window.onload = () => {
      console.log("ğŸŒ load - ëª¨ë“  ë¦¬ì†ŒìŠ¤ ë¡œë”© í›„ ì‹¤í–‰");

      // (ë¬¸ì œ) DOM ì¡°ì‘ì´ ë¶ˆí•„ìš”í•˜ê²Œ loadê¹Œì§€ ëŠ¦ì¶°ì§ â†’ ì´ˆê¸° í™˜ì˜ ë¬¸êµ¬ê°€ ëŠ¦ê²Œ ëœ¸
      document.getElementById("username").textContent = "í™ê¸¸ë™ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!";

      // (ë¬¸ì œ) ì´ë¯¸ì§€ ë†’ì´ ê¸°ë°˜ ë ˆì´ì•„ì›ƒ: DOMContentLoadedì—ì„œ ì‹¤í–‰í•˜ë©´ 0pxê°€ ë‚˜ì˜¤ëŠ” ì¼€ì´ìŠ¤ë¥¼ ìœ ë°œ
      const banner = document.getElementById("banner");
      document.getElementById("card").style.height = banner.naturalHeight + "px";
      console.log("ì¹´ë“œ ë†’ì´(ì˜ëª» ë°˜ì˜ ê°€ëŠ¥):", document.getElementById("card").style.height);

      // (ë¬¸ì œ) beforeunload ê²½ê³ ë§Œ ë„ìš°ê³  ì €ì¥ ì•ˆ í•¨ â†’ ì‹¤ìˆ˜ ì‹œ ë°ì´í„° ìœ ì‹¤
      window.addEventListener("beforeunload", (e) => {
        if (document.querySelector("#report").value.trim() !== "") {
          e.preventDefault();
          e.returnValue = "ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?";
        }
      });

      // (ë¬¸ì œ) fetchëŠ” íƒ­ ì¢…ë£Œ ì¤‘ë‹¨ â†’ ì¢…ë£Œ ë¡œê·¸ ìœ ì‹¤
      window.addEventListener("unload", () => {
        fetch("/analytics/exit", {
          method: "POST",
          keepalive: false,
          body: JSON.stringify({ end: Date.now() })
        });
      });
    };
  </script>

  <style>
    body { font-family: system-ui, sans-serif; margin: 24px; }
    header { margin-bottom: 12px; }
    #card { background: #e5e7eb; margin-top: 10px; display:flex; align-items:center; justify-content:center; }
    textarea { width: 100%; height: 160px; margin-top: 16px; }
  </style>
</head>
<body>
  <header>
    <h1 id="username">ë¡œë”© ì¤‘...</h1>
  </header>

  <!-- ìœ íš¨í•œ ì´ë¯¸ì§€: ë°ì´í„° URI(SVG) -->
  <img id="banner"
       alt="ë°°ë„ˆ ì´ë¯¸ì§€"
       src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='200'%3E%3Crect width='100%25' height='100%25' fill='%23e2e8f0'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='32' fill='%2363748b'%3EBanner%20800x200%3C/text%3E%3C/svg%3E" />

  <section id="card">
    <p>ì¹´ë“œ ì½˜í…ì¸ (ë°°ë„ˆ ë†’ì´ì— ë§ì¶° ì„¸ë¡œ í¬ê¸°ë¥¼ ì§€ì •í•´ì•¼ í•¨)</p>
  </section>

  <textarea id="report" placeholder="ì—¬ê¸°ì— ë³´ê³ ì„œë¥¼ ì‘ì„±í•˜ì„¸ìš”(ì‘ì„± ì¤‘ ì´íƒˆ ì‹œ ìœ ì‹¤ ìœ„í—˜)"></textarea>
</body>
</html>
