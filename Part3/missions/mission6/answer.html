<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì¥ë°”êµ¬ë‹ˆ (ìµœì í™”ëœ UI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style>
      /* ========== Base & Motion Preferences ========== */
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Segoe UI", Roboto, system-ui, -apple-system, sans-serif;
        margin: 0;
        background: #f3f4f6;
        color: #111827;
      }
      /* ì‚¬ìš©ì ëª¨ì…˜ ê°ì†Œ ì„¤ì • ì¡´ì¤‘: ì• ë‹ˆë©”ì´ì…˜ ìµœì†Œí™” */
      @media (prefers-reduced-motion: reduce) {
        .card:hover {
          transform: none;
        }
        .btn {
          transition: none;
        }
      }

      /* ========== Header ========== */
      header {
        background: linear-gradient(90deg, #2563eb, #1d4ed8);
        color: #fff;
        padding: 16px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky;
        top: 0;
        z-index: 10;
      }
      .logo {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 700;
        font-size: 20px;
      }

      /* ========== Layout: 2-Column with Sticky Aside ========== */
      main {
        max-width: 1120px;
        margin: 24px auto;
        padding: 0 16px;
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 24px;
      }

      /* ========== Cart List Card ========== */
      .card {
        display: flex;
        gap: 16px;
        align-items: center;
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 16px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
        /* transformë§Œ ì‚¬ìš© â†’ í˜ì¸íŠ¸ë³´ë‹¤ ì €ë ´(ê°€ëŠ¥í•˜ë©´ í•©ì„± ë‹¨ê³„ ì²˜ë¦¬) */
        transition: transform 0.15s ease;
      }
      .card:hover {
        transform: translateY(-2px);
      }
      .thumb {
        /* í¬ê¸° ì˜ˆì•½ + cover â†’ CLS ë°©ì§€ */
        width: 120px;
        height: 90px;
        aspect-ratio: 4/3;
        border-radius: 8px;
        object-fit: cover;
        flex: 0 0 auto;
      }
      .info {
        flex: 1;
        min-width: 0;
      }
      .info h4 {
        margin: 0 0 6px;
        font-size: 16px;
      }
      .info p {
        margin: 0 0 8px;
        color: #374151;
        font-weight: 600;
      }
      .qty {
        font-size: 14px;
        color: #4b5563;
      }
      .qty input {
        width: 64px;
        padding: 6px 8px;
        margin-left: 6px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 14px;
      }

      /* ========== Aside (Order Summary) ========== */
      aside {
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
        height: fit-content;
        position: sticky;
        top: 84px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      aside h3 {
        margin: 0;
        font-size: 18px;
        font-weight: 700;
      }
      .summary {
        border-top: 1px solid #e5e7eb;
        padding-top: 12px;
      }
      .row {
        display: flex;
        justify-content: space-between;
        margin: 8px 0;
        color: #374151;
      }
      .row strong {
        color: #111827;
      }
      .actions {
        display: flex;
        gap: 8px;
      }
      .actions input[type="text"] {
        flex: 1;
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 14px;
      }

      /* ========== Buttons ========== */
      .btn {
        padding: 10px 14px;
        border: 0;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 600;
        font-size: 15px;
        transition: transform 0.06s ease, background 0.2s ease,
          box-shadow 0.2s ease;
      }
      .btn:active {
        transform: translateY(1px);
      }
      .btn.primary {
        background: #2563eb;
        color: #fff;
      }
      .btn.primary:hover {
        background: #1d4ed8;
      }
      .btn.outline {
        background: #fff;
        color: #111827;
        border: 1px solid #d1d5db;
      }
      .btn.outline:hover {
        background: #f3f4f6;
      }
      .btn.loading {
        opacity: 0.6;
        pointer-events: none;
      } /* ì‹œê°ì /ë§ˆìš°ìŠ¤ ì°¨ë‹¨ */

      /* ========== Misc ========== */
      #cart-list {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .badge {
        display: inline-block;
        padding: 2px 8px;
        background: #eff6ff;
        color: #1d4ed8;
        border-radius: 999px;
        font-size: 12px;
        margin-left: 8px;
      }

      /* ëª¨ë°”ì¼: 1ì—´ ì „í™˜, sticky í•´ì œ */
      @media (max-width: 900px) {
        main {
          grid-template-columns: 1fr;
        }
        aside {
          position: static;
          top: auto;
        }
      }

      /* ì ‘ê·¼ì„±: ìŠ¤í¬ë¦°ë¦¬ë” ì „ìš© ì˜ì—­ */
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      /* (ì˜µì…˜) ì˜¤í”„ìŠ¤í¬ë¦° ë¹„ìš© ì ˆê°: ì´ˆê¸° ë ˆì´ì•„ì›ƒ ì˜ˆì¸¡ì¹˜ ì œê³µ */
      @supports (content-visibility: auto) {
        .card {
          content-visibility: auto;
          contain-intrinsic-size: 150px 360px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="logo">ğŸ›’ MyShop <span class="badge">Cart</span></div>
      <nav class="nav">ê³ ê°ì„¼í„° | ë¡œê·¸ì¸</nav>
    </header>

    <main>
      <!-- ì™¼ìª½: ì¥ë°”êµ¬ë‹ˆ ë¦¬ìŠ¤íŠ¸ -->
      <section id="cart-list" aria-label="ì¥ë°”êµ¬ë‹ˆ í•­ëª© ëª©ë¡"></section>

      <!-- ì˜¤ë¥¸ìª½: ì£¼ë¬¸ ìš”ì•½ -->
      <aside aria-labelledby="order-summary-title" aria-busy="false">
        <h3 id="order-summary-title">ì£¼ë¬¸ ìš”ì•½</h3>

        <!-- ê°€ê²© ì •ë³´ëŠ” ë¼ì´ë¸Œ ì˜ì—­ìœ¼ë¡œ ì¦‰ì‹œ ì½ì–´ì£¼ê¸° -->
        <div class="summary" aria-live="polite">
          <div class="row">
            <span>ìƒí’ˆ í•©ê³„</span><span id="subtotal">â‚©0</span>
          </div>
          <div class="row">
            <span>í• ì¸</span><span id="discount">- â‚©0</span>
          </div>
          <div class="row">
            <strong>ì´ ê²°ì œ ê¸ˆì•¡</strong><strong id="total">â‚©0</strong>
          </div>
        </div>

        <div class="actions">
          <input
            type="text"
            id="coupon"
            placeholder="í• ì¸ ì½”ë“œ ì…ë ¥ (ì˜ˆ: SAVE10)"
            aria-label="í• ì¸ ì½”ë“œ ì…ë ¥"
          />
          <button
            class="btn outline"
            id="btn-coupon"
            aria-label="í• ì¸ ì½”ë“œ ì ìš©"
            aria-disabled="false"
          >
            ì ìš©
          </button>
        </div>
        <button
          class="btn primary"
          id="btn-pay"
          aria-label="ê²°ì œí•˜ê¸°"
          aria-disabled="false"
        >
          ê²°ì œí•˜ê¸°
        </button>

        <!-- ë¹„ì°¨ë‹¨ ìƒíƒœ ì•Œë¦¼ -->
        <div id="toast" class="sr-only" aria-live="polite"></div>
      </aside>
    </main>

    <script>
      /* ================= Utilities ================= */
      const fmt = new Intl.NumberFormat("ko-KR", {
        style: "currency",
        currency: "KRW",
        maximumFractionDigits: 0,
      });
      const $ = (s) => document.querySelector(s);
      const $$ = (s) => document.querySelectorAll(s);

      // ì…ë ¥ ê³¼ë°œí™” ë°©ì§€: ì…ë ¥ì´ ë©ˆì¶˜ ë’¤ Nms í›„ ì‹¤í–‰
      const debounce = (fn, d = 120) => {
        let t;
        return (...args) => {
          clearTimeout(t);
          t = setTimeout(() => fn(...args), d);
        };
      };

      // ì•ˆì „í•œ ì •ìˆ˜ ë³€í™˜ + ë²”ìœ„ ë³´ì •(ìµœì†Œ 1, ìµœëŒ€ 99)
      const safeInt = (v, { min = 1, max = 99 } = {}) => {
        let n = parseInt(v, 10);
        if (Number.isNaN(n)) n = min;
        return Math.max(min, Math.min(max, n));
      };

      // ë¹„ì°¨ë‹¨ í† ìŠ¤íŠ¸: alert ëŒ€ì²´. SRì— ì¦‰ì‹œ ì½í˜.
      function toast(msg) {
        const t = $("#toast");
        t.classList.remove("sr-only");
        t.textContent = msg;
        setTimeout(() => {
          t.classList.add("sr-only");
          t.textContent = "";
        }, 1500);
      }

      // ê³µí†µ ë¡œë”© ìƒíƒœ í† ê¸€: ì‹œê°Â·í‚¤ë³´ë“œÂ·SR ëª¨ë‘ ë°˜ì˜
      function setLoading(button, text) {
        button.classList.add("loading");
        button.disabled = true;
        button.setAttribute("aria-disabled", "true");
        const prev = button.textContent;
        button.textContent = text;
        return () => {
          button.classList.remove("loading");
          button.disabled = false;
          button.setAttribute("aria-disabled", "false");
          button.textContent = prev;
        };
      }

      /* ================= Data & Nodes ================= */
      const ITEMS_COUNT = 50;
      const cartList = $("#cart-list");
      const subtotalEl = $("#subtotal");
      const discountEl = $("#discount");
      const totalEl = $("#total");
      const couponInput = $("#coupon");
      const couponBtn = $("#btn-coupon");
      const payBtn = $("#btn-pay");

      let subtotal = 0,
        discount = 0,
        appliedCoupon = null;

      /* ========== Render Items (lazy + í¬ê¸°ì˜ˆì•½ + ì‘ë‹µí•´ìƒë„ + ìºì‹œ ê³ ë ¤) ========== */
      for (let i = 1; i <= ITEMS_COUNT; i++) {
        const price = i * 3000;
        const card = document.createElement("article");
        card.className = "card";
        card.innerHTML = `
        <img class="thumb"
             loading="lazy" decoding="async" fetchpriority="low"
             src="https://picsum.photos/200/150"
             srcset="https://picsum.photos/240/180 240w, https://picsum.photos/480/360 480w, https://picsum.photos/720/540 720w"
             sizes="(max-width: 900px) 33vw, 120px"
             width="120" height="90" alt="ìƒí’ˆ ${i} ì´ë¯¸ì§€">
        <div class="info">
          <h4>ìƒí’ˆ ${i}</h4>
          <p data-price="${price}">${fmt.format(price)}</p>
          <label class="qty">ìˆ˜ëŸ‰:
            <input type="number" inputmode="numeric" pattern="[0-9]*"
                   min="1" value="1" aria-label="ìƒí’ˆ ${i} ìˆ˜ëŸ‰" data-price="${price}">
          </label>
        </div>`;
        cartList.appendChild(card);

        /* (ì˜µì…˜) ì²« ì¹´ë“œ(above-the-fold)ë§Œ fetchpriority="high"ë¡œ ìŠ¹ê²©
      if(i===1){
        const img = card.querySelector('img');
        img.setAttribute('fetchpriority','high'); // LCP í›„ë³´ ë¹ ë¥¸ í™•ë³´
      }
      */
      }

      /* ================= Totals ================= */
      function recalcTotals() {
        let sum = 0;
        $$('#cart-list input[type="number"]').forEach((inp) => {
          const price = Number(inp.dataset.price || 0);
          const qty = safeInt(inp.value, { min: 1, max: 99 });
          sum += price * qty;
        });
        subtotal = sum;

        // ê°„ë‹¨ ì¿ í° ë£°: SAVE10 â†’ 10% (ìµœëŒ€ 50,000)
        discount = 0;
        if (appliedCoupon === "SAVE10") {
          discount = Math.min(Math.round(subtotal * 0.1), 50000);
        }

        subtotalEl.textContent = fmt.format(subtotal);
        discountEl.textContent = `- ${fmt.format(discount)}`;
        totalEl.textContent = fmt.format(Math.max(0, subtotal - discount));
      }
      recalcTotals(); // ì´ˆê¸° 1íšŒë§Œ ì •í™• ê³„ì‚°(ì¤‘ë³µ ëˆ„ì  ì œê±°)

      /* ========== Quantity Change (ë¶€ë¶„ ì—…ë°ì´íŠ¸ + ë””ë°”ìš´ìŠ¤) ========== */
      const onQtyInput = debounce((e) => {
        const el = e.target;
        if (el.matches('input[type="number"]')) {
          el.value = safeInt(el.value, { min: 1, max: 99 }); // ë¹ˆê°’Â·ìŒìˆ˜Â·ê³¼ëŒ€ê°’ ë³´ì •
          recalcTotals(); // í•©ê³„ë§Œ ê°±ì‹  â†’ í˜ì¸íŠ¸ ë²”ìœ„ ì¶•ì†Œ
        }
      }, 120);
      cartList.addEventListener("input", onQtyInput);

      /* ========== Coupon (ì¦‰ì‹œ í”¼ë“œë°± + ë¹„ë™ê¸° + í† ìŠ¤íŠ¸) ========== */
      couponBtn.addEventListener("click", () => {
        if (couponBtn.disabled) return;

        const restore = setLoading(couponBtn, "ê²€ì¦ ì¤‘â€¦");
        const code = (couponInput.value || "").trim().toUpperCase();

        // ì„œë²„ ëŒ€ê¸° ì‹œë®¬ë ˆì´ì…˜
        setTimeout(() => {
          if (code === "SAVE10") {
            appliedCoupon = "SAVE10";
            toast("10% í• ì¸ ì½”ë“œ ì ìš© (ìµœëŒ€ 50,000ì›)");
          } else if (!code) {
            appliedCoupon = null;
            toast("í• ì¸ ì½”ë“œê°€ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.");
          } else {
            appliedCoupon = null;
            toast("ìœ íš¨í•˜ì§€ ì•Šì€ í• ì¸ ì½”ë“œì…ë‹ˆë‹¤.");
          }
          recalcTotals();
          restore();
        }, 300);
      });

      /* ========== Pay (ì¦‰ì‹œ ë°˜ì‘ + ë¹„ë™ê¸°) ========== */
      payBtn.addEventListener("click", () => {
        if (payBtn.disabled) return;

        const restore = setLoading(payBtn, "ê²°ì œ ì²˜ë¦¬ ì¤‘â€¦");
        // ê²°ì œ API ëŒ€ê¸° ì‹œë®¬ë ˆì´ì…˜
        setTimeout(() => {
          toast("ê²°ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
          restore();
        }, 600);
      });
    </script>
  </body>
</html>
